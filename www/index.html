<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <title>Mobil App</title>
		<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"> 
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"-->
	    <link rel="stylesheet" href="css/themes/iss.css" />
	    <link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />	
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.3/jquery.mobile.structure-1.4.3.min.css" />
        <link rel="stylesheet" href="http://leafletjs.com/dist/leaflet.css" />
        <link rel="stylesheet" type="text/css" href="js/leaflet-openweathermap/leaflet-openweathermap.css" />
		<!-- link rel="stylesheet" href="../js/leaflet-locatecontrol/L.Control.Locate.css" / -->
		<!--[if lt IE 9]>
			<link rel="stylesheet" href="//rawgithub.com/domoritz/leaflet-locatecontrol/gh-pages/src/L.Control.Locate.ie.css"/>
		<![endif]-->


		<style>		
			
			@font-face {
				font-family: novaFont;
				src: url(css/fonts/PrintClearly.otf);
			}
			
			#map { 
				margin:-15px;
				height: 100%;
				width:100%; 
			}
			
			.cub{
				font-weight:bold;
				text-shadow:none;
				background-color: transparent;
				text-align:center; 
				height:35px;
				margin-top: 0em; 
				margin-left:0em;
				float: left; 
				color: rgb(244, 244, 244); 
				font-family:novaFont;
				width: 80px; 
			}
			
			.cubTitol { font-size: 0.8em;  height: 6px; width:100%;margin-top:5px;font-family:novaFont;  }
			.cubValor { margin-top:0.2em;font-size: 1.8em;  height: 26px; ; color: #ffffff;width:100%;font-family:novaFont; }
			.cubUnitat { margin-bottom:7px;font-size:0.8em;margin-top:0em;height:15px;font-family:novaFont; }
			
			.cubPetit{
				font-weight:bold;
				text-shadow:none;
				background-color: #ffffff;
				text-align:center; 
				height:37px;				
				float: left; 
				color: rgb(244, 244, 244); 
				font-family:novaFont; 
				width: 80px;
				margin:0;
			}
			
			.cubGran{
				font-weight:bold;
				text-shadow:none;
				background-color: #ffffff;
				text-align:center; 
				height:74px;				
				float: left; 
				color: rgb(244, 244, 244); 
				font-family:Helvetica;
				width: 80px;
				margin:0;
				font-family: novaFont;
			}
			.cubPetitTitol { font-size: 0.6em;  height: 6px; width:100%;margin-top:0px;font-family:novaFont  }
			.cubPetitValor {margin-top:0 em;font-size: 1.2em;  height: 18px; ; color: #ffffff;width:100%;font-family:novaFont }
			.cubPetitUnitat {margin-bottom:7px;font-size:0.6em;margin-top:0em;height:10px;font-family:novaFont }
			.cubsContenidor { width:100%;height:125px;clear:both;border-bottom: 1px dotted #dddddd; }
			.iconWrapper { float:right;margin-right:30px;margin-top:15px}
			
			
		</style>
        <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="http://code.jquery.com/mobile/1.4.3/jquery.mobile-1.4.3.min.js"></script>
        <script type="text/javascript" src="http://leafletjs.com/dist/leaflet.js"></script>
        <script type="text/javascript" src="js/leaflet-openweathermap/leaflet-openweathermap.js"></script>
        <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
        <script src="js/leaflet-plugins-master/layer/tile/Google.js"></script>
		<!-- script src="../js/leaflet-locatecontrol/L.Control.Locate.js" ></script-->
		<script type="text/javascript">	

			var visor = {
				'llistaInicial': 0,
				'map' : {}, // 	Objecte OpenLayers del mapa
				'wpid' : 0,
				'modeNavegacio' : null,
				'modePunt' : null,
				'nouPuntEdicio': null,
				'popup' : null,
				'greenIcon' : {},
				'valoracio' : null,
				'icon' : null,
				'config' : { 'layers' : { 'base' : [], 'overlay' : [] }},
				'posicioActual' : { 'trobat': 0, 'lat' : 0,	'lng' : 0, 'alt' : 0, 'acc' : 0 },
				'posicioAnterior' : { 'trobat': 0, 'lat' : 0,	'lng' : 0, 'alt' : 0, 'acc' : 0 },
				'POI' : [{  'nom' : null , 'descripcio': null , 'lat': null , 'lng':null, 'tema' : null, 'icona' : null , 'seleccionat' : 0, 'distancia' : null}],
				'filtre' : {  'seleccionat' : 0 , 'valoracioMin':0, 'valoracioMax': 100, 'categoria': 'platja.png', 'distancia': 40000 }
			}
			
			// Intentar fer tots els ajustaments disn aquesta funció
			function ajustaFinestres(){			
				var resizeTimer = null;			
				if (resizeTimer) clearTimeout(resizeTimer);			
				resizeTimer = setTimeout(function () {
					$('#map').width($(window).width());
					$('#map').height($(window).height() - $('#header').height() - $('#footer').height() - 8);
					$('#pageListContent').height($(window).height() - $('#pageListHeader').height() - $('#pageListFooter').height() - 89);
					visor.map._onResize(); 
					if 	($(window).width() < 450) {
						$('.imatgeLlistaPOI').hide(200); 
						$('#filtreDistancia').hide(200); 
						$('.cub').addClass( 'cubPetit').removeClass('cub');
						$('.cubTitol').addClass( 'cubPetitTitol').removeClass('cubTitol');
						$('.cubValor').addClass( 'cubPetitValor').removeClass('cubValor');
						$('.cubUnitat').addClass( 'cubPetitUnitat').removeClass('cubUnitat');
						$('.cubWrapper').width(80);	
						$('.iconWrapper').css({'marginTop':'9px', 'float':'left', 'marginLeft':'15px'});
					}
					if 	($(window).width() >= 450) {
						$('.imatgeLlistaPOI').show(200); 
						$('#filtreDistancia').show(200); 
					}				
				});
			}
			
			function ajustaPortada(){			
				var resizeTimer = null;			
				if (resizeTimer) clearTimeout(resizeTimer);			
				resizeTimer = setTimeout(function () {
					$('#fotoPortada').height($(window).height());				
				});
			}
			
			/*function ordenaPOIDistanciaMain(){			
				var resizeTimer = null;			
				if (resizeTimer) clearTimeout(resizeTimer);			
				resizeTimer = setTimeout(function () {
					ordenaPOIDistancia();				
				});
			}
			*/
			
			
			function baseLayer(seleccionada){			
				 $.each(visor.config.layers.base, function(i,item){
					 if (visor.map.hasLayer(item)){
						  visor.map.removeLayer(item);				  
					 }			 
				 });
				 
				 visor.map.addLayer(seleccionada);
				 //visor.map(seleccionada);
				 }
		
			function overlayLayer(seleccionada){			
				 visor.map.addLayer(seleccionada);
				 seleccionada.setOpacity(0.5);			 
			}
			
			function removeAllOverlay(){
				 $.each(visor.config.layers.overlay, function(i,item){
					 if (visor.map.hasLayer(item)){
						  visor.map.removeLayer(item);
						  return false;
					 }			 
				 });			
			}
			
			function nextOverlayLayer(count){			 
				var overlayLayersLength = visor.config.layers.overlay.length;
				var mostra = null;			
				
				$.each(visor.config.layers.overlay, function(i,item){
					mostra = i + count;
					// Selecciona la capa overlay activa   
					if (visor.map.hasLayer(item)){
						// Si és el darrer i és demana el següent torna a començar
						if (i == overlayLayersLength - 1 && count > 0 ){
							mostra = 0;				
						}
						// Si és el primer i es demana l'anterior
						if (i == 0 && count < 0 ){
							mostra = overlayLayersLength - 1;
						}
						removeAllOverlay();
						overlayLayer(visor.config.layers.overlay[mostra]);
						$('#layerName').html(visor.config.layers.overlay[mostra].options.id);
						return false;
					}	
					// Si no hi ha cap capa activa selecciona la primera
					if (i == overlayLayersLength - 1) {
						overlayLayer(visor.config.layers.overlay[0]);
						$('#layerName').html(visor.config.layers.overlay[0].options.id);
					}				
				});					
			}	
		
			function centraPosicioActual(punt,zoom){
				if (visor.posicioActual.lat != 0){				
					if(zoom > 1){
						visor.map.setView([punt.lat, punt.lng], zoom);
					}
					else{
						visor.map.setView([punt.lat, punt.lng]);			
					}
				}
				else{
				$( "#popupActPos").popup( "close" )	
				}
			}
			
			function successGeo(position) {
				var latitude = position.coords.latitude;
				var longitude = position.coords.longitude;
				var altitude = position.coords.altitude;
				var accuracy = position.coords.accuracy;
				//visor.map.setView([latitude, longitude], 19);
				
				visor.posicioActual = { 'trobat' : 1,
										'lat' : latitude,
										'lng' : longitude,
										'alt' : altitude,
										'acc' : accuracy };
										
				if (latitude == 0 ) { 
					alert ('Posició no vàlida');
					visor.posicioActual = { 'trobat' : 0,
										'lat' : 41.5419 ,
										'lng' : 2.447,
										'alt' : altitude,
										'acc' : accuracy };					
					//return false;	
				}
				else {
				
				
				}
							
				if (visor.modePunt == 'seguiment' ) {
					L.marker([visor.posicioActual.lat, visor.posicioActual.lng],{icon:visor.smallIcon}).addTo(visor.map);
				}
				
				if (visor.modeNavegacio == 'centrat' ){
					visor.map.setView([visor.posicioActual.lat, visor.posicioActual.lng], 20);			
				}
				
				//if (visor.POI[0].length == 0 ) {
				//alert('CreaPOI');
				if ( visor.posicioAnterior.lat -  visor.posicioActual.lat > 0.0001 || visor.posicioActual.lat -  visor.posicioAnterior.lat > 0.0001 ) {
					creaLlistaPOI();
				}	
				//}	
				//ordenaPOIDistanciaMain();
				//alert('OrdenaPOI');
				visor.posicioAnterior = visor.posicioActual;
			}
				
			function errorGeo(error) {				
				visor.posicioActual = { 'trobat' : 0,
					'lat' : 0,
					'lng' : 0,
					'alt' : 0,
					'acc' : 0 };
				alert('No estan activades les opcions de geolocalització');
				visor.posicioActual = { 'trobat' : 1,
										'lat' : 43.5419 ,
										'lng' : 2.447,
										'alt' : 1,
										'acc' : 1 };		
				


				
			};
			
			// Create the XHR object.
			function createCORSRequest(method, url) {
			  var xhr = new XMLHttpRequest();
			  if ("withCredentials" in xhr) {
				// XHR for Chrome/Firefox/Opera/Safari.
				xhr.open(method, url, true);
			  } else if (typeof XDomainRequest != "undefined") {
				// XDomainRequest for IE.
				xhr = new XDomainRequest();
				xhr.open(method, url);
			  } else {
				// CORS not supported.
				xhr = null;
			  }
			  return xhr;
			}

			// Helper method to parse the title tag from the response.
			function getTitle(text) {
			  return text.match('<title>(.*)?</title>')[1];
			}

			// Make the actual CORS request.
			function makeCorsRequest(url,params) {
			  // All HTML5 Rocks properties support CORS.
			
			  var xhr = createCORSRequest('POST', url);
			  if (!xhr) {
				alert('CORS not supported');
				return;
			  }
			
			  //xhr.setRequestHeader('Content-Type', 'application/text/plain'); 
			  xhr.onreadystatechange = function() {
					if(xhr.readyState == 4 && xhr.status == 200) {
						alert('Tested OK');
						var text = xhr.responseText;
						alert('Response from CORS request to ' + url + ': ' + text);
					}
				};
				
			
					  // Response handlers.
			  xhr.onload = function() {
				var text = xhr.responseText;
				var title = getTitle(text);
				return title;
			  };

			  xhr.onerror = function() {
				alert('Woops, there was an error making the request.');
			  };

			  xhr.send(params);
			}
			
			function carregaDades(){

				var DATA_SERVICE_URL = "https://script.google.com/macros/s/AKfycbw0Z4GBFA_vj2b1CAWMiJA9Zh6Gph770Eth8L8sTuUtth0wQ8o/exec?jsonp=callback";
				var scriptElement = document.createElement('script');
				scriptElement.src = DATA_SERVICE_URL;
				document.getElementsByTagName('head')[0].appendChild(scriptElement);
			
			}
			
			function callback(data) {			
				for (var i = 0; i < data.length - 1 ; i++) {			 
					
					visor.POI[i] = { 'nom' : data[i+1][3],
									 'lat' : data[i+1][1].split('at: ')[1],
									 'lng' : data[i+1][2].split('ng: ')[1],
									 'descripcio' : data[i+1][4],
									 'valoracio' : data[i+1][5],
									 'seleccionat' : 0,
									 'icon' : data[i+1][6] };
					
					//visor.POI[i].distancia = L.latLng(visor.posicioActual.lat, visor.posicioActual.lng).distanceTo(L.latLng(visor.POI[i].lat, visor.POI[i].lng));
						
					var iconMap = L.icon({
						iconUrl: 'images/' + data[i+1][6],
						shadowUrl: '',
						iconSize:     [30, 30], // size of the icon
						shadowSize:   [25, 32], // size of the shadow
						iconAnchor:   [1, 1], // point of the icon which will correspond to marker's location
						shadowAnchor: [4, 62],  // the same for the shadow
						popupAnchor:  [15, 0 ] // point from which the popup should open relative to the iconAnchor
					});		  
							
					//if ( data[i][6] !='../images/platja.png' ){ alert ( visor.greenIcon.iconUrl ); }
					L.marker([visor.POI[i].lat, visor.POI[i].lng],{icon:iconMap}).addTo(visor.map)
					.bindPopup(visor.POI[i].icon);
				}
				
				
				//visor.map.setView([data[1][1].split('at: ')[1], data[1][1]].split('ng: ')[1], 7);					
			}
			
			function creaCubDades( titol, valor, unitat , colorFons){

				//var colorF = (colorFons.length > 4 ) ? colorFons : "#ffffff";
				var colorF = "transparent";
				var cubTitol = $('<div/>',{
					'class' : 'cubTitol',
					'style' : 'color:' + colorFons	 + ';' 
						  +   'height:0px;'	
						  +   'overflow:hidden;'		
					})
					.html(  titol );
				
				var cubValor = $('<div/>',{
					'class' : 'cubValor',
					'style' : 'color:' + colorFons	
					})
					.html( valor );			
				
				var cubUnitat = $('<div/>',{
					'class' : 'cubUnitat',
					'style' : 'color:' + colorFons	 + ';' 
						  +   'height:0px;'	
						  +   'overflow:hidden;'
					})
					.html( unitat );			
				
				var cub =$('<div/>',{
					'class' : 'cub',
					'style' : 'background-color:' + colorF 	+';'
					      +   'width:200px'
					
					})
					.append(cubTitol)
					.append(cubValor)
					.append(cubUnitat);				
				
				return cub;	
				
			}
			
			function creaCubDadesGran( titol, valor, unitat , colorFons){

				var colorF = (colorFons.length > 4 ) ? colorFons : "#ffffff";
				
				var cubTitol = $('<div/>',{
					'class' : 'cubTitol',
					'style' : 'font-size: 1.3em;'
							+ 'color:#444499;'
							+ 'font-family: novaFont;'							
							+ 'height:5px;'
							+ ' margin-top:0px;'					
					})
					.html(  titol );
				
				var cubValor = $('<div/>',{
					'class' : 'cubValor',
					'style' : 'font-size: 3em;'
							+ 'color:#444499;'
							+ 'height:40px;'
							+ 'font-family: novaFont;'
							+ 'font-weight: bold'
					})
					.html( valor );			
				
				var cubUnitat = $('<div/>',{
					'class' : 'cubUnitat',
					'style' : 'font-size: 1em;'
						+ 'font-family: novaFont;'
						+ ' margin-top:5px;'
						+ 'font-weight: bold;'
						+ 'color:#444499;'
						+ 'height:25px;'				
					})
					.html( unitat );			
				
				var cub =$('<div/>',{
					'class' : 'cub',
					'style' : 		'background-color: ' + colorF + ';' 
								+ 	'height:auto;'
								+   'border-right:2px solid #44aa88;'
								+   'margin-top:10px;'
								+   'margin-bottom:10px;'
								+   'width:80px'
 					
					})
					.append(cubTitol)
					.append(cubValor)
					.append(cubUnitat);				
				
				return cub;	
				
			}
			
			
					
			function creaLlistaPOI() {			
				var elementLlista = null;
				var cub1 = null;
				var cub2 = null;
				var cub3 = null;
				var cub4 = null;
				var softColor = null;
				var distancia = null;
				var unitat = 'Km';
				var recorregut = "--";				
				if( visor.llistaInicial < 300002){
				$('#pageListContentUI').html('');
				
				for (var i = 0; i < visor.POI.length - 1 ; i++) {	
					visor.POI[i].distancia =  L.latLng(visor.posicioActual.lat, visor.posicioActual.lng).distanceTo(L.latLng(visor.POI[i].lat, visor.POI[i].lng));
				}
							
				for (var i = 0; i < visor.POI.length - 1  ; i++) {	
					softColor = (parseInt(i/2) == i/2) ? "#ffffff" : "#f2f2f2";				
					//distancia =  L.latLng(visor.posicioActual.lat, visor.posicioActual.lng).distanceTo(L.latLng(visor.POI[i].lat, visor.POI[i].lng));
					distancia = visor.POI[i].distancia;
					//console.log(distancia);
					if  (visor.POI[i].seleccionat == 1 ) { softColor =  "#ffffd5"}
					
					if ( distancia < 10000 ) {
						recorregut = parseInt(distancia * 60 / 3000);	// promig de 3 km/h per persona				
					} 
					else {
						recorregut = '--';
					}
					
					
					if ( distancia < 1000 ) {
						distancia = parseInt(distancia);
						unitat = 'm';					
					} 
					else {
						distancia =  ( distancia > 10000 )  ?  parseInt(distancia/1000) : parseFloat(distancia/1000).toFixed(2);
						unitats = 'Km';			
					}
					console.log(distancia);
					cubGran = creaCubDadesGran("",recorregut, 'min',"transparent");
					//cub1 = creaCubDades("","<span style='font-size:0.6em'>Distància: </span>" + distancia +" "+ "<span style='font-size:0.8em'>m</span>", "","#f2c300");
					//alert(cub1.html());
					//cub2 = creaCubDades("","<span style='font-size:0.6em'>Recorregut: </span>" + recorregut+" "+ "<span style='font-size:0.8em'>" + unitat + "</span>", "","#ff4a4a");
					//cub3 = creaCubDades("","<span style='font-size:0.6em'>Comença: </span>" +"10:00","hh:mm","#9cabe4");
					//cub4 = creaCubDades("","<span style='font-size:0.8em'>Acaba: </span>" +"19:00","hh:mm","#675fd6");     							
					
					
					
					
					var cubsContenidorExtern = $('<div/>',{
						'class' : 'cubsContenidor',
						'style' : 'background-color:' + softColor
						})

						.append( ""
							+  "         <div class='imatgeLlistaPOI' style='float:left;height:125px;width:auto'>"
							+  "           	<div class='cubWrapper' style='margin-left:5px;padding:0em;width:auto;height:75px;float:left;'> "
							+	cubGran[0].outerHTML 
							+  "            </div>"							
							+  " 			<div style='margin-left:10px;float:left'  />"
							+  "         </div>"
							+  "		 <div class='imatgeLlistaPOI' style='font-weight:bold;float:right;height:125px;width:170px;font-size:1.2em;'>"
							+  "         	<div style='margin-top:10px;border-left:2px solid #44aa88;padding:0em;width:160px;height:30px;float:right;'> "
							+  "				<div style='font-weight:bold;width:100%;font-family:novaFont;margin-left:10px;;color:#44aa88'> <img width='32' src='images/recorregut.png' style='float:left;margin-top:-1px;margin-right:8px'/ > <span style='font-size:1.4em;'> " 
							+ 						distancia + " </span>"
							+ 						unitats 
							+  "				</div>"
							+  "         	</div>" 							
							+  "         	<div style='margin-top:0px;border-left:2px solid #44aa88;padding:0em;width:160px;height:30px;float:right;'> "
							+  "				<div style='width:100%;font-family:novaFont;margin-left:10px;color:#44aa88'> <img width='24' src='images/inici.png' style='float:left;margin-top:5px'/ > <span style='font-size:1.4em;'> "
							+  "					10:00 </span>"
							+  "				</div>"
							+  "         	</div>" 
							+  "         	<div style='margin-top:0px;border-left:2px solid #44aa88;padding:0em;width:160px;height:30px;float:right;'> "
							+  "				<div style='width:100%;font-family:novaFont;margin-left:10px;color:#44aa88'> <img width='24' src='images/inici.png' style='float:left;margin-top:5px'/ > <span style='font-size:1.4em;'> "
							+  "					12:00 </span>"
							+  "				</div>"
							+  "         	</div>" 							
							
							//	+		cub1[0].outerHTML 
						//	+		cub2[0].outerHTML 
						//	+		cub3[0].outerHTML 
						//	+		cub4[0].outerHTML 
 
							+  "         </div>"  
							// +  "     <img width=16 height=16 src='images/" + visor.POI[i].icon + "' class='ui-li-icon ui-corner-none'>"
							+  "        <div style='height:36px;margin-right:30px;width:100%;'>"
							+  "            <div class='iconWrapper'>"
							+  "        		<img onclick='if (visor.POI[" + i + "].seleccionat == 1){ visor.POI[" + i + "].seleccionat = 0 } else {visor.POI[" + i + "].seleccionat = 1} ;creaLlistaPOI();' width='23' src='images/camp.png' style='float:left'/ >"
							+  "        		<img width='30' src='images/ciutat.png' style='float:left'/ >"						
							+  "        		<img width='30' src='images/muntanya.png' style='float:left'/ >"						
							+  "        		<img width='30' src='images/platja.png' style='float:left'/ >"
							+  "    		</div>"
							+  "    	</div>"	
							+  " 	    <div style='height:auto;width:100%;;margin-left:20px	'>"
							+  "			<div style='font-family:novaFont; font-size: 1.2em; font-weight:bold;cursor:pointer;color:#44aa88;width:auto' onclick='window.open(\"http://www.google.com\")'> " + visor.POI[i].nom + "</div> "
	//						+  "	    	<p class='ui-li-aside'><strong>" + i + 1 +"</strong></p>  "
							+  " 	    	<div style='width:100%;font-size:0.7em;color:#8f8f8f'>" + visor.POI[i].descripcio + "</div>"
							+  "     	</div> ");
							
				
					var cond = 1;
					
					// Apliquem el filtre
					
					if (   
					visor.filtre.distancia >= visor.POI[i].distancia 
						&& visor.filtre.valoracioMax > visor.POI[i].valoracio
						&& visor.filtre.valoracioMin < visor.POI[i].valoracio
//y						&& visor.filtre.categoria == visor.POI[i].icon
						)
					{
						if (visor.filtre.seleccionat == 0  ){
								 $('#pageListContentUI').append(cubsContenidorExtern);
						}
						else {  // serà igual a 1	
							if (visor.POI[i].seleccionat == 1 ) {
								$('#pageListContentUI').append(cubsContenidorExtern);
							}			
						}						
					}
				}
				ordenaPOIDistancia();
				
				$('#pageListContentUI').listview('refresh');
				ajustaFinestres();
				visor.llistaInicial += 1;
				}
				//alert(cub);
				//alert (	visor.POI[visor.POI.length-1].descripcio + 	visor.POI[visor.POI.length-1].nom)
			}	
			
			/*function posicionaPuntActual(){
				var callbacks = $.Callbacks();
				callbacks.add( geoFindMe );
				callbacks.add( centra );
				callbacks.fire();
			}
			
			function centra(){
				console.log('centra');
				
				if (visor.posicioActual.lat == 0) {
					//alert('sense ubicació');
				}
				else {
					visor.map.setView([visor.posicioActual.lat, visor.posicioActual.lng], 13);
				}		
			}
			*/
			
			function activaGeoposicionament(){		
				var geo_options = {
					enableHighAccuracy: true,
					maximumAge : 30000,
					timeout : 27000
				};			
		
				visor.wpid = navigator.geolocation.watchPosition(successGeo, errorGeo, geo_options);
		//		mostraMissatge('buscantPosició');
			}
			
			/*function mostraPunt(){
				var callbacks = $.Callbacks();
				callbacks.add( geoFindMe );
				callbacks.add( actualitzaForm );
				callbacks.fire();
			}*/
			
			function recuperaAdreca(punt){
				$.getJSON("http://nominatim.openstreetmap.org/reverse?json_callback=?", 
					{ format: "json", lat: punt.lat, lon: punt.lng, zoom: 18, addressdetails: 1 },
					function(data) { 
						$('#descripcio').val(data.display_name);
				});			
			}
					
			function recuperaDades( ) {
			
				var frm = {URL: null, param:[] };			
				frm.param[0] = 0;			
				frm.param[1] = $('#basic').val();
				
				if (visor.map.lat = 0) { //TODO pendemt de revisar
					frm.param[2] = 'lng: ' + String(visor.nouPuntEdicio.lng);
					frm.param[3] = 'lat: ' + String(visor.nouPuntEdicio.lat);
				}
				else {
					frm.param[2] = 'lng: ' + String(visor.nouPuntEdicio.lng);
					frm.param[3] = 'lat: ' + String(visor.nouPuntEdicio.lat);
				}

				frm.param[4] =  $('#descripcio').val();
				frm.param[5] =  $('#slider-1').val();
				//frm.param[5] =  $('#slider-1').val();
				//$( "input[name*='man']" ).val( "has man in it!" );
				
			//	$("input[name*='radio-choice']").each(function(){ 
			//		alert(this.val() ) 
			// 	});
				var options = $( ".selector" ).controlgroup( "option" );
				
				
				frm.param[6] =  $('input[name="radio-choice"]:checked', '#varis').val() + '.png';			
				
				frm.URL = "https://docs.google.com/forms/d/1xtHPIhEMG68gwCsxX2HFml4mXxh34JMCT6ShnTEBOJI/formResponse";
				
				var adrecaURL = 'http://nominatim.openstreetmap.org/reverse?format=json&zoom=18&addressdetails=1';
				

				
				
				/*lat='
					+  visor.posicioActual.lat 
					+  '&lon='
					+   visor.posicioActual.lng;
				

		
				$.ajax({
					url: adrecaURL,
					 xhrFields: {
						withCredentials: true
					},				
					data: {
						'lat': visor.posicioActual.lat,
						'lon': visor.posicioActual.lng
					},
					type: "POST",
					dataType: "json",
					//contentType: "text/xml; charset=\"utf-8\"",
					crossDomain: true,
					success: function (data, textStatus, XMLHttpRequest) {
						console.log(data);
					},
					error: function (XMLHttpRequest, textStatus, errorThrown) {
						$("#dialog-form").dialog("close");
						console.log("problemes");
						console.log(textStatus);
					}
				});
				*/
			
				return frm;	
			}
				
			function onMapClick(e) {
				
				var contingutPopup =  '<div data-demo-html="true">'
									+ ' 	<form><fieldset data-role="controlgroup">'
									+ '			<legend>Ubicació:</legend>'
									+ ' 		<input type="radio" name="radio-1" id="radio-1" value="GPS" checked="checked" />'
									+ ' 		<label for="radio-1">Segons GPS - Ubicació Actual</label>'				
									+ ' 		<input type="radio" name="radio-1" id="radio-2" value="Mapa"  />'
									+ '			<label for="radio-2">Segons Mapa - Ubicació del mapa</label>'		     	
									+ ' 	</fieldset></form>'
									+ ' </div>';		
				visor.nouPuntEdicio = e.latlng;
				visor.popup
					.setLatLng(e.latlng)
					.setContent("<div onclick='recuperaAdreca( L.latLng(" 
								+  e.latlng.lat + "," 
								+  e.latlng.lng + "))' > Clica <a href='#pagetwo'>aquí</a> per guardar el punt"
							//	+  e.latlng.toString() 
								+ "</div>")
							//	+ contingutPopup )
					.openOn(visor.map);
			}
			
			function inicialitzaMapa(){
				visor.map = L.map('map');
				
				visor.popup = L.popup();

				visor.map.on('click', onMapClick);
				
				visor.greenIcon = L.icon({
					iconUrl: 'images/platja.png',
					shadowUrl: '',
					iconSize:     [30, 30], // size of the icon
					shadowSize:   [25, 32], // size of the shadow
					iconAnchor:   [0, 0], // point of the icon which will correspond to marker's location
					shadowAnchor: [4, 62],  // the same for the shadow
					popupAnchor:  [15, 0 ] // point from which the popup should open relative to the iconAnchor
				});
				
				visor.smallIcon = L.icon({
					iconUrl: 'images/platja.png',
					shadowUrl: '',
					iconSize:     [5, 5], // size of the icon
					shadowSize:   [3, 3], // size of the shadow
					iconAnchor:   [0, 0], // point of the icon which will correspond to marker's location
					shadowAnchor: [3, 3],  // the same for the shadow
					popupAnchor:  [0, 0 ] // point from which the popup should open relative to the iconAnchor
				});
				
				
				
				// Definició de capes
				
				var Esri_WorldImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
					attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
				});
				
				
				
				var icc = L.tileLayer('http://geoserveis.icc.cat/icc_mapesbase/wms/service', {
						id:'ICGC',
						layers: 'mtc5m',
						format: 'image/png',
					   // transparent: true,
						attribution: 'ICGC'
					});			
				
				var osm = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
					id: 'osm',
					attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
				});
				
				var esri = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}', {
					id:'esri',
					attribution: 'Tiles &copy; Esri &mdash; Source: US National Park Service',
					maxZoom: 8
				});
				
				
				var nexrad = L.tileLayer.wms("http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi", {
					id:'nexrad',
					layers: 'nexrad-n0r-900913',
					format: 'image/png',
					transparent: true,
					attribution: "Weather data © 2012 IEM Nexrad"
				});
				
				var SST = L.tileLayer.wms("http://myocean.artov.isac.cnr.it/thredds/wms/SST_MED_SST_L4_NRT_OBSERVATIONS_010_004_c_V2",{
					id:'SST',
					layers: 'analysed_sst',
					format: 'image/png',
					transparent: true,
					attribution: ""
				});
					
					
				var SSWVW= L.tileLayer.wms("http://gnoodap.bo.ingv.it/thredds/wms/myov03-med-ingv-cur-an-fc",{
					id:'SSWVW',
					layers: 'surface_sea_water_velocity_produced_by_sea_surface_waves',
					format: 'image/png',
					transparent: true,
					attribution: ""
				});
						
				var clouds = L.OWM.clouds({id:'cloud'});
				
				var temp = L.OWM.temperature({id:'temp'});
				
				var cloudscls = L.OWM.cloudsClassic({id:'cloudscl'});
				
				var precipitation = L.OWM.precipitation({id:'precipitation'});
				
				var precipitationcls = L.OWM.precipitationClassic({id:'precipitationcls'});
				
				var rain = L.OWM.rain({id:'rain'});
				
				var raincls = L.OWM.rainClassic({id:'raincls'});
				
				var snow = L.OWM.snow({id:'snow'});
				
				var pressure = L.OWM.pressure({id:'pressure'});
				
				var pressurecntr = L.OWM.pressureContour({id:'pressurecntr'});
				
				var temp = L.OWM.temperature({id:'temp'});
				
				var wind = L.OWM.wind({id:'wind'});

				var ggl = new L.Google('');
				
				var ggl2 = new L.Google('TERRAIN');
		
				
				visor.config.layers.base = [ggl, ggl2, osm , Esri_WorldImagery ];
				visor.config.layers.overlay = [ SST, SSWVW, clouds, cloudscls, temp, precipitation, precipitationcls, rain, raincls, snow, pressure, pressurecntr, wind ];
				baseLayer(osm);
				//visor.map.addLayer(ggl);
				visor.map.setView([51.505, -0.09], 5);	

				var baseMaps = {
						"Mapa": visor.config.layers.base[0],
						"Satèl·lit": visor.config.layers.base[1]
				};
				
				var overlayMaps ={
						"Núvols": visor.config.layers.overlay[2],
						"Temperature": visor.config.layers.overlay[6]
				};
				
				
				
			
			}	
			
			function actualitzaForm( frm ) {
					
				$.ajax({
					url: frm.URL,
					 xhrFields: {
						withCredentials: true
					},				
					data: {
					   // formkey: '1xtHPIhEMG68gwCsxX2HFml4mXxh34JMCT6ShnTEBOJI',		            		  	
						'draftResponse': 	"[,,'9343310141278937']",
						'entry.1118535733': frm.param[2],
						'entry.1366413431': frm.param[3],
						'entry.2081033554': frm.param[4],
						'entry.334554466': frm.param[1],
						'entry.657320122': frm.param[5],
						'entry.806099471': frm.param[6],
						'fbzx': 9343310141278937,
						'pageHistory': 0
					},
					type: "POST",
					dataType: "xml",
					crossDomain: true,
					success: function (data, textStatus, XMLHttpRequest) {
						$("#dialog-form").dialog("close");
						//console.log("success");
						//console.log(data);
					},
					error: function (XMLHttpRequest, textStatus, errorThrown) {
						$("#dialog-form").dialog("close");
						//console.log("error");
						//console.log(textStatus);
					}
				});
			}
			
			function ordenaPOIDistancia(){
				// Recalcula distància
				
				visor.POI.sort(function(a, b){ return a.distancia-b.distancia});
			}
				
			function creaHome(){
				
				//$.support.cors                 = true;
				//$.mobile.allowCrossDomainPages = true;
				//$.mobile.pushStateEnabled      = false;
				 
				//var titolHeader = 'Aquest és el nou títol';
				//visor.modePunt = 'seguiment';
				//visor.modeNavegacio = 'centrat' ;
				//activaGeoposicionament(); 
				//visor.modePunt == 'punt' ;
				//	 $('#index').trigger('pagecreate');
				//ajustaFinestres();		
				//var lc = L.control.locate().addTo(visor.map);
				//lc.locate(); 
			 }

			function activaFiltrePOI(){
				visor.filtre.seleccionat = 	$('#veureFavorits').val();
				visor.filtre.distancia = 	$('#distanciaMaxima').val();
				visor.filtre.categoria = 	$('#categoria').val();
				visor.filtre.valoracioMin = 	$('#valoracioMin').val();
				visor.filtre.valoracioMax = 	$('#valoracioMax').val();
				creaLlistaPOI();
			}
			
			
			$( document ).on('pageshow' ,'#portada', function(){ 
				$(window).bind('resize', function () {ajustaPortada();});
				//$.mobile.page.prototype.options.theme = "b";
				$('#pageList').trigger('pagecreate');
				activaGeoposicionament();
				carregaDades();					 
				ajustaPortada();
				inicialitzaMapa();			
			 });
				 
			$( document ).on('pagebeforehide' ,'#pagetwo', function(){ 
				carregaDades();
			});

			$( window ).on( 'orientationchange', function( event ) {ajustaPortada(); });
			 
			$( document ).on('pageshow','#pageMap', function(){
				$(window).bind('resize', function () {ajustaFinestres();ajustaPortada();});			
				ajustaFinestres();
			});
			
			$( document ).on('pageshow','#pageList', function(){
				//$(window).bind('resize', function () {ajustaFinestres();ajustaPortada();});			
				ajustaFinestres();
			});
						
				//L.control.layers(baseMaps, overlayMaps).addTo(visor.map);	
				// add an OpenStreetMap tile layer
				// add a marker in the given location, attach some popup content to it and open the popup
				/*
					L.marker([51.5, -0.09]).addTo(map)
					.bindPopup('A pretty CSS3 popup. <br> Easily customizable.')
					.openPopup();
				*/	

	/*		function onLocationFound(e) {			
				var radius = e.accuracy / 2;			
				L.marker(e.latlng).addTo(map)
				.bindPopup("You are within " + radius + " meters from this point").openPopup();			
				L.circle(e.latlng, radius).addTo(map);
			}

			function onLocationError(e) {
				L.map('map').setView([51.505, -0.09], 13);
			}
	*/

			function actualitzaFormulari(){		
		}
	
	</script>
	
    </head>
    <body>
		<div data-role="page" id="portada" style="width:100%;height:100%;margin:0px;">  
            <div data-role="content" style="width:100%;height:100%;padding:0em" id ="fotoPortada" >   		
           		<a href="#pageMap"><img  style="height:100%;width:102 %;" src="images/home.png" />	</a>
			</div>
        </div>
    	 
    	<div data-role="page" id="pageMap" >  
            <div data-role="header"  role="banner" id = "header" style="z-index: 1; box-shadow:0px 2px 6px #444444;">
				
			    <a data-inline="true" value="on"  style="" checked="checked" type="radio" onclick=" visor.map.setView([visor.posicioActual.lat, visor.posicioActual.lng], 20);" href="#" class="ui-btn-left ui-btn ui-icon-navigation ui-btn-icon-left ui-shadow ui-corner-all "> Troba'm </a>			    	
				
				<!--a href="#portada" class="ui-btn-left ui-btn ui-icon-home ui-btn-icon-left ui-shadow ui-corner-all">Home</a-->
				<h1 class="ui-title" role="heading" aria-level="1">Street Finder</h1> 
				<a href="#pageList" href="#pageList"  class="ui-btn ui-icon-bullets ui-btn-icon-left ui-shadow ui-corner-all">Llista</a>
				<div data-type="horizontal" data-role="controlgroup" style="position:absolute;top:47px;right:3px;">
			    	<a value="on"  checked="checked" type="radio" onclick="baseLayer(visor.config.layers.base[2])" href="#" class="ui-btn ">Map</a>
			    	<a value="off" checked="checked" type="radio" onclick="baseLayer(visor.config.layers.base[0])" href="#" class="ui-btn ">Sat</a>
				</div>
				
				
			</div>           
            <div data-role="content" id="contMapa"> 
					<div id="map"></div>
			</div>               
            <div data-role="footer"  id = "footer" style="box-shadow: 0 0 8px 2px rgb(68, 68, 68);"> 
				<div data-type="horizontal" data-role="controlgroup" style="text-align:center;">	
					<a onclick="nextOverlayLayer(-1)" href="#" style="width:30px;height:16px;"  class="ui-btn ui-shadow ui-corner-all ui-btn-icon-notext ui-icon-arrow-l"></a>
			    	<a style="margin-top: 0px;width:120px" id="layerName"   class="ui-btn ">Layers</a>
					<a onclick="nextOverlayLayer(1)" href="#" style="width:30px;height:16px;" class="ui-btn ui-shadow ui-corner-all ui-btn-icon-notext ui-icon-arrow-r"></a>
      			</div>			
			</div>
        </div>
		
		<div data-role="page" id="pageList"  data-dialog="false" data-transition="slidedown">  
            <div data-role="header"  role="banner" id = "pageListHeader" style="z-index: 1; box-shadow:0px 2px 6px #444444;"> 
				<a href="#pageMap" class="ui-btn-left ui-btn ui-icon-back ui-btn-icon-left ui-shadow ui-corner-all">Mapa</a>
				<h1 class="ui-title" role="heading" aria-level="1">Near Events</h1> 
				<a href="#pageFilter" class="ui-btn ui-icon-plus ui-btn-icon-left ui-shadow ui-corner-all">Filtrar</a>			
			</div>           
            <div data-role="content"  id="pageListContent" > 
				<ul data-role="listview" id="pageListContentUI" >

				</ul>		
			</div>
		    <div data-role="footer"  id = "pageListfooter" style="font-style:novaFont;box-shadow: 0 0 8px 2px rgb(68, 68, 68);" >
				<div data-role="controlgroup" data-type="horizontal" class="ui-mini" style="display:inline-block;">
					<a onclick= " visor.filtre.seleccionat = 1; creaLlistaPOI(); "   href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-r" >Favs</a>
					<a onclick= " visor.filtre.seleccionat = 0; creaLlistaPOI(); " href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-l">Tots</a>					
				</div>	

				<div data-role="controlgroup" data-type="horizontal" class="ui-mini" style="display:inline-block;" id="filtreDistancia">
					<!-- a onclick= " visor.filtre.distancia = 200; creaLlistaPOI(); "   href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-r" >200m</a-->
					<a onclick= " visor.filtre.distancia = 500; creaLlistaPOI(); " href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-l">500m</a>					
					<a onclick= " visor.filtre.distancia = 2000; creaLlistaPOI(); "   href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-r" >2 Km</a>
					<!--a onclick= " visor.filtre.distancia = 2000; creaLlistaPOI(); " href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-l">2 Km</a-->					
					<a onclick= " visor.filtre.distancia = 400000; creaLlistaPOI(); "   href="#" data-role="button" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-r" >Tots</a>
				</div>	
				
				<a href="#pageFilter" class="ui-btn ui-btn-right ui-icon-plus ui-btn-icon-left ui-shadow ui-corner-all">Opcions</a>	
				
				
				
				
				
				
				
				<!--div data-role="data-demo-html">
					<div data-role="popup" id="popupActPos" class="ui-content" style="max-width:280px">
						<a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
						<p> Actualitzant la posició</p>
					</div>	
			    	<a onclick="baseLayer(visor.config.layers.base[0])" href="#" class="ui-btn ">Map</a>
			    	<a onclick="baseLayer(visor.config.layers.base[1])" href="#" class="ui-btn ">Sat</a>
					<a href="#pagetwo" onclick="recuperaAdreca(visor.map.getBounds().getCenter())"  class="ui-btn">Captura</a>
					<a onclick=" visor.map.setView([visor.posicioActual.lat, visor.posicioActual.lng], 20);" class="ui-btn">Pos. Actual</a>
					<a style="margin-top: 0px;" onclick="nextOverlayLayer(-1)" href="#" class="ui-btn ui-shadow ui-corner-all ui-btn-icon-notext ui-btn ui-icon-arrow-l"></a>
			    	<a style="margin-top: 0px;width:120px" id="layerName" href="#" class="ui-btn ">Layers</a>
					<a  style="margin-top: 0px;" onclick="nextOverlayLayer(1)" href="#" class="ui-btn ui-shadow ui-corner-all ui-btn-icon-notext ui-btn ui-icon-arrow-r"></a>
      			</div-->			
			</div>
        </div>
   
		<div data-role="page" data-dialog="true" data-transition="slidedown" id="pagetwo">
		  <div data-role="header">
		    <h1>Entrada de dades</h1>
		  </div>
		  <!--a href="#popupBasic" data-rel="popup" class="ui-btn ui-corner-all ui-shadow ui-btn-inline" data-transition="pop">Basic Popup</a>
			<div data-role="popup" id="popupBasic">
				<p>This is a completely basic popup, no options set.</p>
			</div -->
		  
		  <div data-role="main" class="ui-content">
		  	 <form id='varis' action="actualitzaForm($('#basic').val(), '11','11','11','11');" method="post">		    	
				<label for="basic">Nom</label>
  				<input type="text" name="name" id="basic" value=""  />
  				<label for="basic">Descripció</label>
  				<input type="text" name="descripcio" id="descripcio" value=""  />  				
		       	<label for="slider-1">Valoració</label>
				<input type="range" name="slider-1" id="slider-1" value="50" step="10" min="0" data-highlight="true" max="100" />					
				<!--fieldset data-role="controlgroup">
					<legend>Ubicació:</legend>
			     	<input type="radio" name="radio-1" id="radio-1" value="GPS" checked="checked" />
			     	<label for="radio-1">Segons GPS - Ubicació Actual</label>				
			     	<input type="radio" name="radio-1" id="radio-2" value="Mapa"  />
			     	<label for="radio-2">Segons Mapa - Ubicació del mapa</label>		     	
				</fieldset-->				
				
				<fieldset data-role="controlgroup">
					<legend>Tria grup:</legend>
			     	<input type="radio" name="radio-choice" id="radio-choice-1" value="platja" checked="checked" />
			     	<label for="radio-choice-1">Platja</label>				
			     	<input type="radio" name="radio-choice" id="radio-choice-2" value="muntanya"  />
			     	<label for="radio-choice-2">Muntanya</label>				
			     	<input type="radio" name="radio-choice" id="radio-choice-3" value="camp"  />
			     	<label for="radio-choice-3">Camp</label>				
			     	<input type="radio" name="radio-choice" id="radio-choice-4" value="ciutat"  />
			     	<label for="radio-choice-4">Ciutat</label>
				</fieldset>							
				
		    	<input value="Guardar dades" type="button" onclick="var dades=recuperaDades(); actualitzaForm(dades); $.mobile.changePage($('#pageMap'), 'pop', false, true);"> 
				
		    	<!--input value="Button" type="button" onclick=" actualitzaForm('DD',visor.map.getBounds().getCenter().lng,visor.map.getBounds().getCenter().lat, ', $('#slider-1').val());"-->
				
		    </form>
		   
		  </div>
		</div>  
		<div data-role="page" data-dialog="true" data-transition="slidedown" id="pageFilter">		 
			<div data-role="header">
				<h1>Filtre Esdeveniments</h1>
			</div>
			  <!--a href="#popupBasic" data-rel="popup" class="ui-btn ui-corner-all ui-shadow ui-btn-inline" data-transition="pop">Basic Popup</a>
				<div data-role="popup" id="popupBasic">
					<p>This is a completely basic popup, no options set.</p>
				</div -->
			  
			<div data-role="main" class="ui-content">
				<form id='formFilter' action="activaFiltrePOI()" method="post">		    	
					<!--fieldset data-role="controlgroup">
						<legend>Favorits</legend>
						<input type="radio" name="radio-choice" id="radioFavoritsTots" value="platja" checked="checked" />
						<label for="radioFavoritsTots">Tots</label>					
						<input type="radio" name="radio-choice" id="radioFavorits" value="platja" />
						<label for="radioFavorits">Només favorits</label>			
					</fieldset-->
					<div class="ui-field-contain">
						<label style="width:130px" for="veureFavorits"> Només favorits</label>
						<select name="veureFavorits" id="veureFavorits" data-role="slider" data-mini="false" >
							<option value="0">No</option>
							<option value="1">Sí</option>
						</select>
					</div>
					
					<div class="ui-field-contain">
						<div data-role="rangeslider">
							<label for =  "valoracio"> Valoració </label>
							<input name = "valoracio" value="0" step="10" id="valoracioMin" min="0" max="100" value="0" type="range" />
							<input name="valoracio" value="100" step="10" id="valoracioMax" min="0" max="100" value="100" type="range" />
						</div>
					</div>					
					
					
					
					<div class="ui-field-contain">
						<label>Categoria</label>
						<select name="categoria" id="categoria">
							<option value="Tots"> 		Tots		</option>
							<option value="Platja"> 	Platja		</option>
							<option value="Muntanya"> 	Muntanya	</option>
							<option value="Camp"> 		Camp		</option>
							<option value="Ciutat"> 	Ciutat		</option>
						</select>	
					</div>				
		
						
					<div class="ui-field-contain">
						<label>En un radi de</label>
						<select name="distanciaMaxima" id="distanciaMaxima">
							<option value="200"> 200 m </option>
							<option value="500"> 500 m </option>
							<option value="1000"> 1 Km </option>
							<option value="2000"> 2 Km </option>
							<option value="40000"> 40 Km </option>
						</select>	
					</div>				
	

					<!--fieldset data-role="controlgroup">
						<legend>Categoria</legend>
						<input type="radio" name="radio-choice" id="radioCategoriaTots" value="platja" checked="checked" />
						<label for="radioCategoriaTots">Tots</label>					
						<input type="radio" name="radio-choice" id="radioCategoriaPlatja" value="platja" />
						<label for="radioCategoriaPlatja">Platja</label>				
						<input type="radio" name="radio-choice" id="radioCategoriaMuntanya" value="muntanya"  />
						<label for="radioCategoriaMuntanya">Muntanya</label>				
						<input type="radio" name="radio-choice" id="radioCategoriaCamp" value="camp"  />
						<label for="radioCategoriaCamp">Camp</label>				
						<input type="radio" name="radio-choice" id="radioCategoriaCiutat" value="ciutat"  />
						<label for="radioCategoriaCiutat">Ciutat</label>
					</fieldset-->
					
					
					

					
					
					<input value="Aplicar filtre" type="button" onclick="activaFiltrePOI(); $.mobile.changePage($('#pageList'));"> 
					
					<!--input value="Button" type="button" onclick=" actualitzaForm('DD',visor.map.getBounds().getCenter().lng,visor.map.getBounds().getCenter().lat, ', $('#slider-1').val());"-->
					
				</form>			   
			</div>
		  <!--div data-role="footer">
		    <h1> </h1>
		  </div -->
		</div>
		
		
		
		
    </body>
</html>   